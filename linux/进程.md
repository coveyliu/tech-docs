<!-- TOC -->

- [1. 进程的概念](#1-进程的概念)
- [2. 进程查看命令](#2-进程查看命令)
    - [2.1. ps](#21-ps)
    - [2.2. pstree](#22-pstree)
    - [2.3. top](#23-top)
- [3. 进程控制](#3-进程控制)
    - [3.1. 调整优先级](#31-调整优先级)
    - [3.2. 作业控制](#32-作业控制)
- [4. 进程通信方式](#4-进程通信方式)
    - [4.1. 信号](#41-信号)
- [5. 守护进程](#5-守护进程)
    - [5.1. nohub](#51-nohub)
    - [5.2. ~~screen~~](#52-screen)
- [6. 系统日志](#6-系统日志)
- [7. 服务管理工具 systemctl（<u>待补充</u>）](#7-服务管理工具-systemctlu待补充u)
- [8. ~~SELinux 简介~~](#8-selinux-简介)

<!-- /TOC -->



## 1. 进程的概念

- 进程启动和退出
- 进程如何退出？
- linux 第一个进程是什么？

- 父子进程的关系 - 继承





## 2. 进程查看命令



### 2.1. ps

- 常用选项
  - -eLf，
    - 显示所有进程
    - L: 显示进程有多少线程，:stuck_out_tongue:





### 2.2. pstree

- 优点
  - 可以直接显示父子进程关系





### 2.3. top

- 特点
  - 实时显示
  - 显示系统信息
    1. 系统允许时长
    2. 当前登录用户
    3. 负载（系统繁忙程度）
    4. 有多少个进程及进程状态
    5. CPU 使用情况
    6. 内存使用情况
    7. swap 使用情况，**这个啥意思**:grey_question:
  - 显示进程信息
- 用法
  - 1，可以显示所有的 cpu
  - s，可以重置top面板刷新时间（默认 3s)
  - -p pid，只显示一个进程



<img width="80%" src="https://blog-bt.oss-cn-beijing.aliyuncs.com/1/20220405173248.png">



**使用 1 和 s**

<img width="80%" src="https://blog-bt.oss-cn-beijing.aliyuncs.com/1/20220405173337.png">



## 3. 进程控制



### 3.1. 调整优先级



- 使用的指令
  - nice
  - renice，（进程运行期间，就可以调整优先级）
  - 使用方式：`nice|renice pid 新值`
- nice 值范围
  - -20 - 19，值越小优先级越高，抢占资源就越多
- 一个进程启动时
  - 默认的 nice 值 0
  - 进程父进程的 UID，所以，可执行程序跟用户息息相关



**自己写个简单的脚本试试：**

**a.sh**

```bash
#! /bin/bash
echo $$
while :
do
	:
done    
```



**./a.sh**



<img width="50%" src="https://blog-bt.oss-cn-beijing.aliyuncs.com/1/20220405175547.png">





**top -p 24409**

cpu 使用率 100%

<img width="80%" src="https://blog-bt.oss-cn-beijing.aliyuncs.com/1/20220405175653.png">



**renice**

<img width="70%" src="https://blog-bt.oss-cn-beijing.aliyuncs.com/1/20220405175836.png">







### 3.2. 作业控制



- 命令
  - jobs
  - bg
    - bg 任务号
  - fg
    - fg 任务号
  - ctrl + z
    - 让进程暂停（**并不是kill 掉线程**）
- 符号
  - &，（后台运行符号）





**练习，进程前后台运行切换**

**运行脚本 -》top 查看**

![image-20220405180714518](https://blog-bt.oss-cn-beijing.aliyuncs.com/1/20220405180714.png)



**ctrl+z -》top 查看**

![image-20220405180928617](https://blog-bt.oss-cn-beijing.aliyuncs.com/1/20220405180928.png)





**jobs -》fg 1 -》top 查看**

![image-20220405181116874](https://blog-bt.oss-cn-beijing.aliyuncs.com/1/20220405181117.png)



**ctrl+z -》bg 1**

<img width="50%" src="https://blog-bt.oss-cn-beijing.aliyuncs.com/1/20220405181243.png">







## 4. 进程通信方式 



### 4.1. 信号



- 信号是进程间通信方式之一，典型用法：终端用户输入一个中断信息，将某个进程终止
- 命令
  - kill -l，查看支持哪些信号及信号值
  - 前台进程运行时，执行 ctrl+c，就是发送的 sigint 信息（相当于 kil -2 pid）
    - *可以在脚本中处理该信号，让程序不能被 ctrl+c 终止*
  - kill -9 pid ，发送的是 SIGKILL 信号，该信号不能被阻塞或处理

<img width="80%" src="https://blog-bt.oss-cn-beijing.aliyuncs.com/1/20220405200842.png">







## 5. 守护进程



### 5.1. nohub

- nohub 和 & 可以让一个命令，忽略（hangup）信号。示例：
  - `nohub tail -f /var/log/messages &` 
  - `nohub java -jar xxx.jar &`
- nohub 和 & 运行的进程并不是 守护进程
- nohub & 用终端启动一个命令后，关闭终端，那么该进程的父进程就是 1
  - 原因：关闭终端，该进程是孤儿进程，被 1 进程收留了
- 和守护进程相同的地方
  - **进程不受终端是否关闭影响**





### 5.2. ~~screen~~



~~没写，当时不知道什么作用~~



## 6. 系统日志



- 位置，`/var/logs`，需要关注下面的日志
  - `messages`, 常规日志
  - `dmesg`, 内核日志
  - `secure`, 安全日志
  - `cron`, 定时任务日志





## 7. 服务管理工具 systemctl（<u>待补充</u>）



- 服务管理工具
  - `service`（centos6）
  - `systemctl`（centos7）

- `systemctl` 常见操作
  - `systemctl start|stop|restart|reload|enable|disable 服务名称`







## 8. ~~SELinux 简介~~



~~先不写了:x:~~











